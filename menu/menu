#!/bin/bash
# Main Menu Script
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# Load system information
HOSTNAME=$(hostname)
IPADDR=$(wget -qO- ipv4.icanhazip.com)
ISP=$(curl -s ipinfo.io/org)
CITY=$(curl -s ipinfo.io/city)
OS=$(cat /etc/os-release | grep PRETTY_NAME | cut -d '"' -f2)

# Show banner
show_banner() {
    clear
    echo -e "${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e "               ${YELLOW}PREMIUM VPS MANAGER${NC}               "
    echo -e "${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${YELLOW}System Information:${NC}"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}❇️ Hostname    ${NC}: $HOSTNAME"
    echo -e " ${GREEN}❇️ IP Address  ${NC}: $IPADDR"
    echo -e " ${GREEN}❇️ ISP         ${NC}: $ISP"
    echo -e " ${GREEN}❇️ City        ${NC}: $CITY"
    echo -e " ${GREEN}❇️ OS          ${NC}: $OS"
    echo -e "${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
}

# Main menu
while true; do
    show_banner
    echo -e " ${YELLOW}SSH & OpenVPN Menu${NC}:"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[1]${NC} • Create SSH Account     ${GREEN}[11]${NC} • Create Trial SSH"
    echo -e " ${GREEN}[2]${NC} • Generate SSH Account   ${GREEN}[12]${NC} • Delete SSH Account"
    echo -e " ${GREEN}[3]${NC} • Extend SSH Account     ${GREEN}[13]${NC} • Check SSH Users"
    echo -e " ${GREEN}[4]${NC} • Delete Expired Users   ${GREEN}[14]${NC} • Monitor SSH Users"
    
    echo -e "\n ${YELLOW}XRAY/V2Ray Menu${NC}:"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[5]${NC} • Create XRAY Account    ${GREEN}[15]${NC} • Create Trial XRAY"
    echo -e " ${GREEN}[6]${NC} • Delete XRAY Account    ${GREEN}[16]${NC} • Check XRAY Users"
    echo -e " ${GREEN}[7]${NC} • Extend XRAY Account    ${GREEN}[17]${NC} • Monitor XRAY Users"
    
    echo -e "\n ${YELLOW}Trojan Menu${NC}:"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[8]${NC} • Create Trojan Account  ${GREEN}[18]${NC} • Create Trial Trojan"
    echo -e " ${GREEN}[9]${NC} • Delete Trojan Account  ${GREEN}[19]${NC} • Check Trojan Users"
    echo -e " ${GREEN}[10]${NC} • Extend Trojan Account ${GREEN}[20]${NC} • Monitor Trojan Users"
    
    echo -e "\n ${YELLOW}System Menu${NC}:"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[21]${NC} • Add/Change Domain     ${GREEN}[26]${NC} • Change Port Services"
    echo -e " ${GREEN}[22]${NC} • Change DNS Settings   ${GREEN}[27]${NC} • Autobackup Data"
    echo -e " ${GREEN}[23]${NC} • Set Auto Reboot      ${GREEN}[28]${NC} • Backup Data"
    echo -e " ${GREEN}[24]${NC} • Check Usage RAM       ${GREEN}[29]${NC} • Restore Data"
    echo -e " ${GREEN}[25]${NC} • Speedtest VPS        ${GREEN}[30]${NC} • Install Webmin"
    
    echo -e "\n ${YELLOW}Additional Menu${NC}:"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[31]${NC} • Add Cloudflare DNS   ${GREEN}[36]${NC} • Install BBR"
    echo -e " ${GREEN}[32]${NC} • Cloudflare Add-Ons   ${GREEN}[37]${NC} • TCP Tweak"
    echo -e " ${GREEN}[33]${NC} • Point Domain         ${GREEN}[38]${NC} • Restart Services"
    echo -e " ${GREEN}[34]${NC} • Change Timezone      ${GREEN}[39]${NC} • System Information"
    echo -e " ${GREEN}[35]${NC} • Update Script        ${GREEN}[40]${NC} • About Script"
    
    echo -e "\n ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e " ${GREEN}[0]${NC} • Exit Menu"
    echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e ""
    read -p " Select menu: " choice

    case $choice in
        1) add-ssh ;;
        2) trial-ssh ;;
        3) renew-ssh ;;
        4) del-expired ;;
        5) add-xray ;;
        6) del-xray ;;
        7) renew-xray ;;
        8) add-trojan ;;
        9) del-trojan ;;
        10) renew-trojan ;;
        11) trial-ssh ;;
        12) del-ssh ;;
        13) check-ssh ;;
        14) monitor-ssh ;;
        15) trial-xray ;;
        16) check-xray ;;
        17) monitor-xray ;;
        18) trial-trojan ;;
        19) check-trojan ;;
        20) monitor-trojan ;;
        21) add-domain ;;
        22) dns-setting ;;
        23) auto-reboot ;;
        24) ram-usage ;;
        25) speedtest ;;
        26) change-port ;;
        27) autobackup ;;
        28) backup ;;
        29) restore ;;
        30) webmin ;;
        31) add-cf ;;
        32) cf-addon ;;
        33) point-domain ;;
        34) timezone ;;
        35) update ;;
        36) bbr ;;
        37) tcp-tweak ;;
        38) restart-services ;;
        39) system-info ;;
        40)
            echo -e ""
            echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
            echo -e " ${YELLOW}              SCRIPT INFORMATION                 ${NC}"
            echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
            echo -e " ${GREEN}❇️ Developer   ${NC}: Your Name"
            echo -e " ${GREEN}❇️ Version     ${NC}: 1.0"
            echo -e " ${GREEN}❇️ Client Name ${NC}: Premium VPS"
            echo -e " ${GREEN}❇️ Expiry Date ${NC}: Lifetime"
            echo -e " ${BLUE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
            ;;
        0) 
            clear
            echo -e "${GREEN}Thank you for using this script${NC}"
            exit 0 
            ;;
        *) 
            echo -e "${RED}Please enter a valid number [0-40]${NC}"
            sleep 2
            ;;
    esac
done 